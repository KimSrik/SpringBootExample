<html layout:decorate="~{layout}">
	<div layout:fragment="content">
		<div class="container my-3">
		
			<div class="my-3 py-3">
					<h2>알림사항 상세보기</h2>
			</div>
		
			<div class="card my-3">		
				<div class="card-body">	
					<table class="table">
						<tr>
							<td class="table-info" style="padding-left:3%">제목</td>
							<td th:text="${notice.title}"></td>
						</tr>
						
						<tr>
							<td class="table-info" style="padding-left:3%">작성자</td>
							<td>
								<span th:if="${notice.writter != null}" th:text="${notice.writter.username}"></span>
							</td>
						</tr>
						
						<tr>
							<td colspan="2">
								<textarea class="form-control bg-white" th:text="${notice.content}" rows="15" readonly></textarea>						
							</td>
						</tr>
						
						<tr>
							<td class="table-info" style="padding-left:3%">조회수</td>
							<td th:text="${notice.views}"></td>
						</tr>
						
						<tr>
							<td class="table-info" style="padding-left:3%">작성일</td>
							<td th:text="${ #temporals.format(notice.createDate, 'yyyy-MM-dd HH:mm:ss') }"></td>
						</tr>
						
						
					</table>
					
					<div class="d-flex justify-content-end">
					
						<a href="javascript:void(0);"
						   th:data-uri="@{|/notice/delete/${notice.id}|}"
						   class="delete btn btn-secondary"
						   sec:authorize="isAuthenticated()"
						   th:if="${notice.writter != null and #authentication.name == notice.writter.username}"	
						   th:text="삭제">
					    </a>
						
						<a href="javascript:void(0);"
						   th:data-uri="@{|/notice/modify/${notice.id}|}"
						   class="modify btn btn-secondary mx-3"
						   sec:authorize="isAuthenticated()"
						   th:if="${notice.writter != null and #authentication.name == notice.writter.username}"	
						   th:text="수정">
					    </a>
					
					
					
						<a class="btn btn-primary mx-3" th:href="@{/notice/list}">목록</a>
					</div>
			
					<hr>
					
					<div>
						<span>이전글</span>
						<span>:: 이전글 링크</span>
					</div>
					
					<div>
						<span>다음글</span>
						<span>:: 다음글 링크</span>
					</div>
					
					<hr>
					
					<div>
						<span>작성자</span>
						<span>
							<span th:if="${notice.writter != null}" th:text="${notice.writter.username}"></span>
						</span>
						
						<span>&nbsp;&nbsp;&nbsp; 최종수정일</span>
						<span th:text="${ #temporals.format(notice.modifyDate, 'yyyy-MM-dd HH:mm:ss') }"></span>
					</div>
					
					<hr>
					<form th:action="@{|/opinion/create/${notice.id}|}" th:object="${opinionForm}" method="post">
						<div th:replace="~{form_errors :: formErrorsFragment}"></div>
						<div class="my-3">지금 보고계시는 화면의 정보와 사용편의성에 만족하십니까?</div>
						<div class="my-3">
							<span>
								<input type="radio" name="rating" value="5"/> 매우 만족 &nbsp;  
								<input type="radio" name="rating" value="4"/> 만족 &nbsp;
								<input type="radio" name="rating" value="3"/> 보통 &nbsp;
								<input type="radio" name="rating" value="2"/> 불만족 &nbsp;
								<input type="radio" name="rating" value="1"/> 매우 불만족 &nbsp;
							</span>
						</div>
						<div class="d-flex">
							<input class="form-control" type="text" name="content" id="content" placeholder="100자 이내로 적어주세요."/>
							<button class="justify-content-end btn btn-primary" style="width:140px;" type="submit">의견 남기기</button>
						</div>
					</form>
				</div>
			</div>
			
			<div class="card my-3">		
				<div class="card-body">	
					<div th:each=" opinion, loop : ${notice.opinionList} " class="py-3">
							<div class="py-2">
								<span>만족도</span>
								<span >
										<input type="radio" th:name="${loop.count}" value="5" th:checked="${opinion.rating == 5}" disabled /> 매우 만족 &nbsp;  
										<input type="radio" th:name="${loop.count}" value="4" th:checked="${opinion.rating == 4}" disabled /> 만족 &nbsp;
										<input type="radio" th:name="${loop.count}" value="3" th:checked="${opinion.rating == 3}" disabled /> 보통 &nbsp;
										<input type="radio" th:name="${loop.count}" value="2" th:checked="${opinion.rating == 2}" disabled /> 불만족 &nbsp;
										<input type="radio" th:name="${loop.count}" value="1" th:checked="${opinion.rating == 1}" disabled /> 매우 불만족 &nbsp;
								</span>
							</div>
							
							<div class="py-2">
								
								<input disabled class="form-control" type="text" name="ocontent" id="ocontent" th:value="${opinion.content}"/>
											
							</div>
							
							<a href="javascript:void(0);" class="modify btn btn-sm btn-outline-secondary" style="box-sizing:border-box;"
								   sec:authorize="isAuthenticated()"
								   th:data-uri="@{|/opinion/modify/${opinion.id}|}"
								   th:if="${opinion.writter != null and #authentication.name == opinion.writter.username}"
								   th:text="수정">
							</a>
							
							<a href="javascript:void(0);"
								   th:data-uri="@{|/opinion/delete/${opinion.id}|}"
								   class="delete btn btn-sm btn-outline-secondary"
								   sec:authorize="isAuthenticated()"
								   th:if="${opinion.writter != null and #authentication.name == opinion.writter.username}"	
								   th:text="삭제">
						    </a>
							
							
					</div>
				</div>
			</div>	
			
				
		</div>
	</div>
	
	<script type="text/javascript" layout:fragment="script">
		
	const delete_elements = document.getElementsByClassName("delete");
	Array.from(delete_elements).forEach(function(element){
		element.addEventListener('click', function(){
			if(confirm("정말로 삭제하시겠습니까?")){
				location.href = this.dataset.uri;
			};
		});
	});
	
	const modify_elements = document.getElementsByClassName("modify");
	Array.from(modify_elements).forEach(function(element){
		element.addEventListener('click', function(){
			if(confirm("정말로 수정하시겠습니까?")){
				location.href = this.dataset.uri;
			};
		});
	});
	

	
	
	
	
	
	</script>
	
	
	
	
	
</html>

